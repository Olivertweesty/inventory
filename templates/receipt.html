<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Receipt</title>
    
    <link rel="stylesheet" type="text/css" href="static/css/print.css">
</head>
<style type="text/css">
    .invoice-box table tr td:last-child {
        text-align: right;
    }
    .invoice-box table tr.total td:nth-child(2) {
        border-top: 2px solid #eee;
        font-weight: bold;
    }

    /*.itemsRow table {
    border:none;
    border-collapse: collapse;
    }

    .itemsRow table td {
        border-left: 1px solid #000;
        border-right: 1px solid #000;
        height: 30px;
    }

    .itemsRow table td:last-child {
        border-right: none;
    }*/

</style>
<style type="text/css" media="print">
@page {
    size: auto;   /* auto is the initial value */
    margin: 0;  /* this affects the margin in the printer settings */
}
</style>

<body>
    <div class="invoice-box" id="printTable">
        <table cellpadding="0" cellspacing="0">
            <tr class="top">
                <td colspan="2">
                    <table>
                        <tr>
   
                            <td class="title" style="text-align:center">
                                <img src="static/img/logo1.png" style="width:100px; max-width:270px;">
                            </td>

                        </tr>
                        <tr>   
                            <td style="text-align:center">
                                <b>The Leading Dealer In : Aluminium, Glass & Accessories</b><br>
                                <b>Located At :
                                Industrial Area Off Kampala Road</b> <br> <b>Ashray Business Park D6</b>
                            </td> 
                        </tr>
                    </table>
                </td>
            </tr>
            
            <tr class="information">
                <td colspan="2">
                    <table>
                        <tr>
                            <td>
                                ZakiHila E.A LTD<br>
                                P.O. BOX 1073 - 00100 , Nairobi<br>
                                info@zakihila.co.ke<br>
                                Tel : 020 8000 530 /020 8000 531 /020 8000 532 <br>
                                K.R.A : P05180316D
                            </td>
                            
                            <td style="text-align:left;">
                                Invoice #: <span id="orderid"></span><br>
                                Date : <span id="dateCreated"></span><br>
                                <hr>
                                Invoice To:<br>
                                <b><span id="customername"></span></b><br>
                                Tel : <span id="customertel"></span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            </table>
           <div class="itemsRow" style="height: 250px;">
            <table style="box-shadow: 0 0 0 1px white; ">
                <thead>
                <tr style="background: #eee; text-align:center;border-bottom: 0px solid #000;font-weight: bold;">
                    <th style="width:80px;">Code</th>
                    <th>Description</th>
                    <th style="width:70px;">Quantity</th>
                    <th style="width:90px;">Unit Price</th>
                    <th style="width:90px;">Total Price</th>
                </tr>
                </thead>
                <tbody id="mytable">
                </tbody>
            </table>
            </div>
            <div>
                <table>
                    
                    <tr style="margin-bottom: 5px;padding-bottom: 10px ">
                        
                        <td style="border: none; width: 100px;">VAT : </td>
                        <td style="border: 1px solid #000 ; width: 100px;height: 10px;"><b><span id="vat"></span></b></td>
                        <td style="border: none; width: 100px;text-align: right;">Transport : </td>
                        <td style="border: 1px solid #000; width: 100px"><b><span id="transport"></span></b></td>
                        <td style="border: none; width: 100px;text-align: right;">Discount : </td>
                        <td style="border: 1px solid #000; width: 100px"><b><span id="discount"></span></b></td>
                    </tr>
                    <br>
                    <tr>
                        <td style="border: none"></td>
                        <td style="border: none"></td>
                        <td style="border: none"></td>
                        <td style="border: none"></td>
                        <td style="text-align: right;">Total : </td>
                        <td style="border: 1px solid #000"><b><span id="total"></span></b></td>
                    </tr>
                </tfoot>
                </table>
            </div>
            <div>
                <b>Terms & Conditions:</b>
                <ul style="font-size: 10px;">
                    <li>Payment Terms strictly as indicated above or sooner on demand</li>
                    <li>An Upfront of 50% is required before delivery of goods</li>
                    <li>Any queries on prices/items supplied must be sent in writting within one weeks from the date of invoice and thereafter will not be entertained</li>
                    <li>Goods may be accepted back only at our discretion. Any return of goods without confirmation signature will be invalid</li>
                </ul>
            </div>
           <!--  <tr class="heading">
                <td>
                    Payment Method
                </td>
                
                <td>
                    Amount#
                </td>
            </tr>
            
            <tr class="details">
                <td id="payment_method">
                    MPESA
                </td>
                <td id="amount_paid">
                    1000
                </td>
            </tr>
            
            <tr class="heading">
                <td>Item</td>
                <td>Unit Price</td>
            </tr>
            
            <tr class="item last">
                
            </tr> -->
            

           
            </div>
        
    <button onclick="printFunc()">Print</button>
</body>
<script src="static/vendor/jquery/jquery.min.js"></script>
<script type="text/javascript">
    
    var id = location.hash.substr(1);
     ajaxObj = $.ajax({ 
        url: "http://"+window.location.hostname+":4000/getreciept/"+id,
        type: "POST",
        contentType: "application/json",  
        success: function(result){
          var total = 0.0;
          console.log(result)
          for(var item in result['items']){
            console.log(result['items'][item]);
            $("#orderid").text(result['orderid']);
            $("#dateCreated").text(result['date']);
            $("#amount_paid").text(result['total_paid']);
            $("#payment_method").text(result['payment_type']);
            $("#customertel").text(result['mobile_number']);
            $("#customername").text(result['customer_name']);
             var itemTotal = (parseFloat(result['items'][item]['selling_price']) * parseInt(result['items'][item]['quantity']))
            total = (total + itemTotal) - (parseFloat(result['items'][item]['discount']) * parseInt(result['items'][item]['quantity']))
            console.log(total)
            var txt = '<tr><td>'+result['items'][item]['product_code']+'</td><td style=" text-align:center">'+result['items'][item]['product_name']+'</td><td>'+result['items'][item]['quantity']+'</td><td>'+result['items'][item]['selling_price']+'</td><td>'+parseFloat(itemTotal)+'</td><tr>'
            //<td>'+result['items'][item]['quantity']+'</td>
            $("#mytable").append(txt);
          }

     
          var blank ='<tr class="heading"><td></td><td></td></tr>'
          if(result['tax'] == "True"){
            $("#vat").text("Ksh. "+parseFloat(0.16 * total).toFixed(2));
            total = ((total + parseFloat(result['transport'])) + parseFloat(0.16 * total)).toFixed(2)
            $("#total").text("Ksh. "+total);
          }else{
            $("#vat").text("Ksh. 0.00");
            total = (total + parseFloat(result['transport']))
            $("#total").text("Ksh. "+total);
          }
          //$("#mytable").append(blank);
          
         $("#transport").text("Ksh. "+parseFloat(result['transport']).toFixed(2));
          $("#discount").text("Ksh. "+parseFloat(result['discount']).toFixed(2));
          
          
          
        } 
      });
</script>
<script src="static/vendor/jquery/jquery.min.js"></script>
<script src="static/js/printThis.js"></script>
<script type="text/javascript">
    function printFunc(){
        $("#printTable").printThis({
            debug: false,
            importStyle: true,
        });
    }
</script>
</html>